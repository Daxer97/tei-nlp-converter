# Example: Custom Domain Mapping Profile
# =========================================
# This file demonstrates how to add NEW annotation types and TEI mappings
# WITHOUT modifying any Python code. Simply create a YAML file like this
# and place it in the mapping_profiles directory.
#
# The system will automatically discover and use this profile.

profile_id: custom_scientific
name: Custom Scientific Domain
description: |
  Example profile showing how to extend the system for a new domain.
  This maps scientific entities like genes, proteins, and chemicals
  to appropriate TEI elements.

# Default rendering strategy for unmapped annotations
default_render_strategy: inline

# Whether to include processing provenance in TEI header
include_provenance: true

# Whether to add certainty attributes to annotations
include_certainty: true

# Whether to use TEI Feature Structures for complex data
use_feature_structures: true

# Whether to generate xml:id attributes
generate_ids: true

# Mapping rules - evaluated in priority order
rules:
  # High-priority domain-specific rules

  # Gene names -> highlighted term with type="gene"
  - annotation_type: entity
    category_pattern: "^(GENE|GENE_NAME)$"
    tei_element: term
    render_strategy: inline
    attribute_map:
      kb_ref: ref          # Map KB reference to @ref attribute
      category: type       # Map category to @type attribute
    include_features:      # Features to include in <fs> element
      - organism
      - chromosome
      - function
    priority: 20

  # Protein names
  - annotation_type: entity
    category_pattern: "^(PROTEIN|PROTEIN_NAME)$"
    tei_element: term
    render_strategy: inline
    attribute_map:
      kb_ref: ref
      category: type
    include_features:
      - uniprot_id
      - function
    priority: 20

  # Chemical compounds
  - annotation_type: entity
    category_pattern: "^(CHEMICAL|COMPOUND|MOLECULE)$"
    tei_element: term
    render_strategy: inline
    attribute_map:
      kb_ref: ref
      category: type
    include_features:
      - formula
      - cas_number
      - inchi_key
    priority: 20

  # Species names -> taxonomic term
  - annotation_type: entity
    category_pattern: "^(SPECIES|ORGANISM|TAXON)$"
    tei_element: name
    render_strategy: inline
    attribute_map:
      kb_ref: ref
      category: type
    include_features:
      - ncbi_taxid
      - kingdom
      - common_name
    priority: 20

  # Experimental methods -> technical term
  - annotation_type: entity
    category_pattern: "^(METHOD|TECHNIQUE|ASSAY)$"
    tei_element: term
    render_strategy: inline
    attribute_map:
      category: type
    priority: 15

  # Measurements and quantities
  - annotation_type: entity
    category_pattern: "^(MEASUREMENT|QUANTITY|VALUE)$"
    tei_element: measure
    render_strategy: inline
    attribute_map:
      unit: unit
      type: type
    include_features:
      - value
      - uncertainty
    priority: 15

  # Citations -> bibliographic reference
  - annotation_type: entity
    category_pattern: "^(CITATION|REFERENCE|PMID)$"
    tei_element: bibl
    render_strategy: inline
    attribute_map:
      kb_ref: corresp
    priority: 15

  # ===== Fallback rules (lower priority) =====

  # Generic person
  - annotation_type: entity
    category_pattern: "^(PERSON|PER|AUTHOR)$"
    tei_element: persName
    render_strategy: inline
    attribute_map:
      kb_ref: ref
    priority: 5

  # Generic organization
  - annotation_type: entity
    category_pattern: "^(ORG|ORGANIZATION|INSTITUTION)$"
    tei_element: orgName
    render_strategy: inline
    attribute_map:
      kb_ref: ref
    priority: 5

  # Catch-all for unmatched entities
  - annotation_type: entity
    tei_element: name
    render_strategy: inline
    attribute_map:
      category: type
      kb_ref: ref
    priority: 0

  # Tokens with full linguistic annotation
  - annotation_type: token
    tei_element: w
    render_strategy: inline
    attribute_map:
      lemma: lemma
      pos: pos
    include_features:
      - morph
      - dep
    priority: 5

  # Dependencies -> standoff links
  - annotation_type: dependency
    tei_element: link
    render_strategy: standoff
    attribute_map:
      label: type
    priority: 5
