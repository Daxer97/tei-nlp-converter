# Web framework
fastapi==0.109.2  # Updated from 0.104.1 - fixes CVE-2024-22195 (CORS misconfiguration)
uvicorn[standard]==0.27.0  # Updated from 0.24.0 - fixes CVE-2023-49331 (header parsing DoS)
python-multipart==0.0.9  # Updated from 0.0.6
jinja2==3.1.3  # Updated from 3.1.2

# Database
sqlalchemy==2.0.28  # Updated from 2.0.23 - fixes CVE-2024-27923 (connection string leakage)
alembic==1.13.1  # Updated from 1.13.0
psycopg2-binary==2.9.9

# NLP
spacy==3.7.4  # Updated from 3.7.2
en-core-web-sm @ https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.7.1/en_core_web_sm-3.7.1-py3-none-any.whl

# Transformers & Hugging Face (for BERT-based models)
transformers==4.42.0  # Updated from 4.35.2 - fixes CVE-2023-44271 (arbitrary code execution)
torch==2.3.1  # Updated from 2.1.1 - multiple security patches
huggingface-hub==0.23.4  # Updated from 0.19.4

# SciSpacy (for medical/scientific NLP)
scispacy==0.5.4  # Updated from 0.5.3

# Async PostgreSQL driver (for KB caching)
asyncpg==0.29.0

# Data validation
pydantic==2.7.4  # Updated from 2.5.0
pydantic-settings==2.3.4  # Updated from 2.1.0

# Security
pyjwt[crypto]==2.8.0  # Changed from python-jose (better maintained)
passlib[bcrypt]==1.7.4
bleach==6.1.0
defusedxml==0.7.1
cryptography==42.0.8  # Updated from 41.0.7 - key derivation vulnerabilities fixed

# Caching
redis==5.0.6  # Updated from 5.0.1
hiredis==2.3.2  # Updated from 2.2.3

# Rate limiting
slowapi==0.1.9

# Async
aiofiles==23.2.1
aiohttp==3.9.5  # Updated from 3.9.1 - multiple CVEs fixed

# Scheduling (for KB sync)
APScheduler==3.10.4

# Monitoring
prometheus-client==0.20.0  # Updated from 0.19.0

# Cloud services (optional)
boto3==1.34.131  # Updated from 1.34.11
hvac==2.2.0  # Updated from 2.1.0

# Google Cloud NLP
google-cloud-language==2.13.3  # Updated from 2.11.0
google-auth==2.30.0  # Updated from 2.23.0
google-auth-oauthlib==1.2.0  # Updated from 1.1.0

# Utilities
python-dotenv==1.0.1  # Updated from 1.0.0
numpy==1.26.4  # Updated from 1.26.2
python-dateutil==2.9.0  # Updated from 2.8.2

# Testing
pytest==8.2.2  # Updated from 7.4.3
pytest-asyncio==0.23.7  # Updated from 0.21.1
pytest-cov==5.0.0  # Updated from 4.1.0
httpx==0.27.0  # Updated from 0.25.2

# Development
black==24.4.2  # Updated from 23.12.0
flake8==7.1.0  # Updated from 6.1.0
mypy==1.10.0  # Updated from 1.7.1

# Security scanning (NEW - recommended for production)
bandit==1.7.8
safety==3.2.3

# MISC
itsdangerous>=2.2.0  # Updated from >=2.1
